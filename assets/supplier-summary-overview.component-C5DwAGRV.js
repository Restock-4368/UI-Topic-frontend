import{x as ue,B as se,y as ne,d as v,o as p,z as ce,A as z,C as de,b as r,_ as U,r as w,q as Q,m as H,p as j,n as I,f as A,a as G,F as Y,j as J,D as N,E as pe,G as ve,e as S,t as x,c as q,H as he,U as ae,O as fe,P as re,I as ge,g as L,i as T,J as me,s as ye}from"./index-InIZ-6yY.js";var _e=ue`
    .p-buttongroup {
        display: inline-flex;
    }

    .p-buttongroup .p-button {
        margin: 0;
    }

    .p-buttongroup .p-button:not(:last-child),
    .p-buttongroup .p-button:not(:last-child):hover {
        border-inline-end: 0 none;
    }

    .p-buttongroup .p-button:not(:first-of-type):not(:last-of-type) {
        border-radius: 0;
    }

    .p-buttongroup .p-button:first-of-type:not(:only-of-type) {
        border-start-end-radius: 0;
        border-end-end-radius: 0;
    }

    .p-buttongroup .p-button:last-of-type:not(:only-of-type) {
        border-start-start-radius: 0;
        border-end-start-radius: 0;
    }

    .p-buttongroup .p-button:focus {
        position: relative;
        z-index: 1;
    }
`,be={root:"p-buttongroup p-component"},we=se.extend({name:"buttongroup",style:_e,classes:be}),Se={name:"BaseButtonGroup",extends:ne,style:we,provide:function(){return{$pcButtonGroup:this,$parentInstance:this}}},oe={name:"ButtonGroup",extends:Se,inheritAttrs:!1};function $e(t,e,s,d,_,c){return p(),v("span",z({class:t.cx("root"),role:"group"},t.ptmi("root")),[ce(t.$slots,"default")],16)}oe.render=$e;var ke={root:{position:"relative"}},Ce={root:"p-chart"},De=se.extend({name:"chart",classes:Ce,inlineStyles:ke}),Pe={name:"BaseChart",extends:ne,props:{type:String,data:null,options:null,plugins:null,width:{type:Number,default:300},height:{type:Number,default:150},canvasProps:{type:null,default:null}},style:De,provide:function(){return{$pcChart:this,$parentInstance:this}}},ie={name:"Chart",extends:Pe,inheritAttrs:!1,emits:["select","loaded"],chart:null,watch:{data:{handler:function(){this.reinit()},deep:!0},type:function(){this.reinit()},options:function(){this.reinit()}},mounted:function(){this.initChart()},beforeUnmount:function(){this.chart&&(this.chart.destroy(),this.chart=null)},methods:{initChart:function(){var e=this;de(()=>import("./auto-CSZ8dA-i.js"),[]).then(function(s){e.chart&&(e.chart.destroy(),e.chart=null),s&&s.default&&(e.chart=new s.default(e.$refs.canvas,{type:e.type,data:e.data,options:e.options,plugins:e.plugins})),e.$emit("loaded",e.chart)})},getCanvas:function(){return this.$canvas},getChart:function(){return this.chart},getBase64Image:function(){return this.chart.toBase64Image()},refresh:function(){this.chart&&this.chart.update()},reinit:function(){this.initChart()},onCanvasClick:function(e){if(this.chart){var s=this.chart.getElementsAtEventForMode(e,"nearest",{intersect:!0},!1),d=this.chart.getElementsAtEventForMode(e,"dataset",{intersect:!0},!1);s&&s[0]&&d&&this.$emit("select",{originalEvent:e,element:s[0],dataset:d})}},generateLegend:function(){if(this.chart)return this.chart.generateLegend()}}};function F(t){"@babel/helpers - typeof";return F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(t)}function ee(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);e&&(d=d.filter(function(_){return Object.getOwnPropertyDescriptor(t,_).enumerable})),s.push.apply(s,d)}return s}function te(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?ee(Object(s),!0).forEach(function(d){Oe(t,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ee(Object(s)).forEach(function(d){Object.defineProperty(t,d,Object.getOwnPropertyDescriptor(s,d))})}return t}function Oe(t,e,s){return(e=xe(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function xe(t){var e=Ae(t,"string");return F(e)=="symbol"?e:e+""}function Ae(t,e){if(F(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var d=s.call(t,e);if(F(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Me=["width","height"];function Ee(t,e,s,d,_,c){return p(),v("div",z({class:t.cx("root"),style:t.sx("root")},t.ptmi("root")),[r("canvas",z({ref:"canvas",width:t.width,height:t.height,onClick:e[0]||(e[0]=function(u){return c.onCanvasClick(u)})},te(te({},t.canvasProps),t.ptm("canvas"))),null,16,Me)],16)}ie.render=Ee;const Be={class:"widget-container"},Le={class:"nav-tabs"},Fe={class:"range-controls"},Ne={class:"datepicker-icon-wrapper"},je={class:"tab-content"},Ie={key:0,class:"content-block"},qe={class:"value"},Te={key:1,class:"content-block"},Ue={class:"value"},Re={key:2,class:"content-block"},Ve=4,We={__name:"supplier-account-widget.component",setup(t){const e=w("earnings"),s=w("week"),d=["today","week","month","year"],_=w([]),c=w(null),u=w(null),g=w([]),$=w(null),M=w(null);Q(async()=>{const o=new H;g.value=await o.getAllEnriched(),console.log("ðŸŸ¢ Loaded orders:",g.value),C(s.value)});const h=j(()=>{const o=g.value.filter(n=>{var i;const a=new Date(n.date);return n.supplier_id===Ve&&c.value&&u.value&&a>=c.value&&a<=u.value&&["Delivered","Paid"].includes((i=n.state)==null?void 0:i.name)});return console.log("ðŸ“¦ Filtered Orders:",o.length,o),console.log("ðŸ“… Range:",c.value,"â†’",u.value),o}),k=j(()=>{const o=h.value.reduce((n,a)=>n+a.totalPrice,0);return console.log("ðŸ’° Earnings:",o),o}),B=j(()=>{const o=h.value.reduce((n,a)=>n+a.requested_products_count,0);return console.log("ðŸ“¦ Supplies Sold:",o),o});function C(o){s.value=o;const n=new Date;switch(o){case"today":c.value=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),u.value=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);break;case"week":const a=new Date(n);a.setDate(n.getDate()-6),c.value=new Date(a),u.value=new Date(n);break;case"month":const i=new Date(n);i.setMonth(n.getMonth()-1),c.value=new Date(i),u.value=new Date(n);break;case"year":const y=new Date(n);y.setFullYear(n.getFullYear()-1),c.value=new Date(y),u.value=new Date(n);break}_.value=null,b()}function m(o){o&&Array.isArray(o)&&o.length===2&&(c.value=o[0],u.value=o[1],s.value="custom",b())}function b(){if(!(c.value instanceof Date)||isNaN(c.value)||!(u.value instanceof Date)||isNaN(u.value))return;const o=new Map,n=l=>{switch(s.value){case"today":return`${l.getHours().toString().padStart(2,"0")}:00`;case"week":return l.toLocaleDateString("en-US",{weekday:"short"});case"month":return`Week ${Math.ceil(l.getDate()/7)}`;case"year":return l.toLocaleDateString("en-US",{month:"short"});default:return l.toLocaleDateString("en-GB")}};h.value.forEach(l=>{const f=new Date(l.date),R=n(f);o.set(R,(o.get(R)||0)+l.totalPrice)});const a=[],i=[];if(s.value==="today")for(let l=0;l<24;l++){const f=`${l.toString().padStart(2,"0")}:00`;a.push(f),i.push(o.get(f)||0)}else if(s.value==="week")["Mon","Sun","Tue","Wed","Thu","Fri","Sat"].forEach(l=>{a.push(l),i.push(o.get(l)||0)});else if(s.value==="month")for(let l=1;l<=5;l++){const f=`Week ${l}`;a.push(f),i.push(o.get(f)||0)}else if(s.value==="year")["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].forEach(l=>{a.push(l),i.push(o.get(l)||0)});else{const l=new Date(c.value);for(;l<=u.value;){const f=l.toLocaleDateString("en-GB");a.push(f),i.push(o.get(f)||0),l.setDate(l.getDate()+1)}}const y=Math.max(...i,0),O=y>1e3?500:y>200?100:20,E=12;let D=[],P=[];if(a.length<=E)D=a,P=i;else{const l=Math.ceil((a.length-2)/(E-2));D.push(a[0]),P.push(i[0]);for(let f=1;f<a.length-1;f++)(f-1)%l===0&&(D.push(a[f]),P.push(i[f]));D.push(a[a.length-1]),P.push(i[i.length-1])}$.value={labels:D,datasets:[{label:"Earnings",data:P,fill:!0,borderColor:"#42A5F5",backgroundColor:"rgba(66,165,245,0.2)",tension:.4}]},M.value={maintainAspectRatio:!1,responsive:!0,plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{beginAtZero:!0,ticks:{color:"#495057",stepSize:O},grid:{color:"#ebedef"}}},layout:{padding:{top:10,bottom:10}}}}return(o,n)=>(p(),v("div",Be,[r("ul",Le,[r("li",{class:I({active:e.value==="earnings"}),onClick:n[0]||(n[0]=a=>e.value="earnings")},"Earnings",2),r("li",{class:I({active:e.value==="supplies"}),onClick:n[1]||(n[1]=a=>e.value="supplies")},"Supplies",2),r("li",{class:I({active:e.value==="chart"}),onClick:n[2]||(n[2]=a=>e.value="chart")},"Chart",2)]),r("div",Fe,[A(N(oe),null,{default:G(()=>[(p(),v(Y,null,J(d,a=>A(N(pe),{key:a,label:a.charAt(0).toUpperCase()+a.slice(1),outlined:s.value!==a,severity:s.value===a?"success":"secondary",onClick:i=>C(a)},null,8,["label","outlined","severity","onClick"])),64)),r("div",Ne,[n[4]||(n[4]=r("span",{class:"icon-label"},"Fecha",-1)),A(N(ve),{modelValue:_.value,"onUpdate:modelValue":[n[3]||(n[3]=a=>_.value=a),m],selectionMode:"range",showIcon:"",iconDisplay:"icon",dateFormat:"dd/mm/yy",class:"minimal-datepicker-icon-only"},null,8,["modelValue"])])]),_:1})]),r("div",je,[e.value==="earnings"?(p(),v("div",Ie,[n[5]||(n[5]=r("h4",null,"Earnings",-1)),r("p",qe,"S/. "+x(k.value.toFixed(2)),1)])):S("",!0),e.value==="supplies"?(p(),v("div",Te,[n[6]||(n[6]=r("h4",null,"Supplies Sold",-1)),r("p",Ue,x(B.value),1)])):S("",!0),e.value==="chart"?(p(),v("div",Re,[$.value?(p(),q(N(ie),{key:0,type:"line",data:$.value,options:M.value,style:{height:"220px"}},null,8,["data","options"])):S("",!0)])):S("",!0)])]))}},ze=U(We,[["__scopeId","data-v-d586a5ee"]]),Ge={key:0,class:"mobile-header"},Ye={class:"widget-container"},Je={key:0},Qe=1,He={__name:"supplier-notifications-widget.component",setup(t){const e=w([]),s=w(!1),d=he(),_=["restaurant","status","orderPlaced"],c=["restaurant","status"],u=j(()=>s.value?c:_);function g(){s.value=window.innerWidth<=800}Q(async()=>{g(),window.addEventListener("resize",g);const M=new H,h=new fe,k=new ae,B=new re,[C,m]=await Promise.all([M.getByQuery("supplier_id",Qe),h.getAll()]),b=Array.isArray(C.data)?C.data:[],o=Array.isArray(m.data)?m.data:[],n=new Map(o.map(i=>[i.id,i])),a=await Promise.all(b.map(async i=>{var K,X,Z;const y=n.get(i.order_to_supplier_situation_id),O=await k.getByQuery("id",i.admin_restaurant_id),E=(K=O==null?void 0:O.data)==null?void 0:K[0];if(!E)return null;const D=await B.getByQuery("user_id",E.id),P=(X=D==null?void 0:D.data)==null?void 0:X[0],l=((Z=P==null?void 0:P.business)==null?void 0:Z.name)??"Unknown",f=new Date(i.date??""),le=new Date-f,V=Math.floor(le/6e4);let W="";return V<60?W=`${V} min ago`:W=`${Math.floor(V/60)} hr ago`,{restaurant:l,status:(y==null?void 0:y.name)??"Unknown",orderPlaced:W,createdAt:new Date(i.date)}}));e.value=a.filter(Boolean).sort((i,y)=>y.createdAt-i.createdAt)}),ge(()=>{window.removeEventListener("resize",g)});function $(){d.push("/dashboard/supplier/orders")}return(M,h)=>{const k=L("pv-column"),B=L("pv-button"),C=L("pv-data-table");return p(),v("div",null,[s.value?(p(),v("div",Ge,[r("h3",{class:"text-lg font-semibold"},[h[1]||(h[1]=T("Last Notifications ")),r("button",{onClick:$,class:"view-all-btn text-sm"},h[0]||(h[0]=[r("i",{class:"pi pi-arrow-right ml-2"},null,-1)]))])])):S("",!0),r("div",Ye,[s.value?S("",!0):(p(),v("div",Je,[r("h3",{class:"text-lg font-semibold"},[h[3]||(h[3]=T("Last Notifications ")),r("button",{onClick:$,class:"view-all-btn text-sm"},h[2]||(h[2]=[r("i",{class:"pi pi-arrow-right ml-2"},null,-1)]))])])),r("div",{class:"scroll-wrapper",style:me({overflowY:e.value.length>3?"auto":"visible"})},[A(C,{value:e.value,responsiveLayout:"scroll"},{default:G(()=>[u.value.includes("restaurant")?(p(),q(k,{key:0,field:"restaurant",header:"Restaurant",class:"text-sm"})):S("",!0),u.value.includes("status")?(p(),q(k,{key:1,field:"status",header:"Status"},{body:G(({data:m})=>[A(B,{label:m.status,class:I(["text-white w-10rem text-sm font-normal border-round-sm h-2rem",m.status.toLowerCase().includes("declined")?"bg-red-500":m.status.toLowerCase().includes("approved")?"bg-green-600":"bg-orange-500"])},null,8,["label","class"])]),_:1})):S("",!0),u.value.includes("orderPlaced")?(p(),q(k,{key:2,field:"orderPlaced",header:"Order placed",class:"text-sm"})):S("",!0)]),_:1},8,["value"])],4)])])}}},Ke=U(He,[["__scopeId","data-v-8cc8d283"]]),Xe={key:0,class:"mobile-header"},Ze={class:"frequent-customers-container"},et={key:0,class:"header"},tt={key:1,class:"cards-grid"},st={class:"card-header"},nt={class:"category"},at={class:"description"},rt={key:2,class:"frequent-grid"},ot={class:"category"},it={class:"description text-xs text-gray-600"},lt=1,ut={__name:"supplier-frequent-customers-widget.component",setup(t){const e=w([]),s=w(!1);function d(){s.value=window.innerWidth<=800}return Q(async()=>{d(),window.addEventListener("resize",d);const _=new H,c=new ae,u=new re,g=await _.getAll(),M=((g==null?void 0:g.data)||[]).filter(m=>m.supplier_id===lt),h=new Map;for(const m of M){const b=m.admin_restaurant_id;h.set(b,(h.get(b)??0)+1)}const k=Array.from(h.entries()).sort((m,b)=>b[1]-m[1]).slice(0,6),C=(await c.getByRoleId(2)).data||[];e.value=await Promise.all(k.map(async([m,b])=>{var i,y,O;const o=C.find(E=>E.id===m),n=await u.getByQuery("user_id",m),a=(i=n==null?void 0:n.data)==null?void 0:i[0];return{name:((y=a==null?void 0:a.business)==null?void 0:y.name)||(o==null?void 0:o.email)||"Unknown",category:((O=a==null?void 0:a.business)==null?void 0:O.categories)||"No category",description:`Has placed ${b} order${b>1?"s":""} in total.`,count:b}}))}),(_,c)=>(p(),v("div",null,[s.value?(p(),v("div",Xe,c[0]||(c[0]=[r("h3",null,"Frequent Customers",-1)]))):S("",!0),r("div",Ze,[s.value?S("",!0):(p(),v("div",et,c[1]||(c[1]=[r("h3",null,"Frequent Customers",-1)]))),s.value?(p(),v("div",rt,[(p(!0),v(Y,null,J(e.value,(u,g)=>(p(),v("div",{class:"restaurant-card",key:g},[r("h4",null,x(u.name),1),r("p",ot,[c[3]||(c[3]=r("i",{class:"pi pi-tag mr-1"},null,-1)),T(" "+x(u.category),1)]),r("p",it,x(u.description),1)]))),128))])):(p(),v("div",tt,[(p(!0),v(Y,null,J(e.value,(u,g)=>(p(),v("div",{class:"customer-card",key:g},[r("div",st,[r("h4",null,x(u.name),1)]),r("p",nt,[c[2]||(c[2]=r("i",{class:"pi pi-tag mr-2"},null,-1)),T(" "+x(u.category),1)]),r("p",at,x(u.description),1)]))),128))]))])]))}},ct=U(ut,[["__scopeId","data-v-912a6fcb"]]),dt=ye({name:"supplier-summary-overview",components:{SupplierAlertsWidget:Ke,SupplierAccountWidget:ze,SupplierFrequentCustomersWidget:ct}}),pt={class:"analytics-grid"},vt={class:"row1"},ht={class:"widget-alerts"},ft={class:"widget-account"},gt={class:"row2"},mt={class:"widget-frequent"};function yt(t,e,s,d,_,c){const u=L("supplier-alerts-widget"),g=L("supplier-account-widget"),$=L("supplier-frequent-customers-widget");return p(),v("div",pt,[r("div",vt,[r("div",ht,[A(u)]),r("div",ft,[A(g)])]),r("div",gt,[r("div",mt,[A($)])])])}const bt=U(dt,[["render",yt]]);export{bt as default};
